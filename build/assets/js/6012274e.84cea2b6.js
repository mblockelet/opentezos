"use strict";(self.webpackChunkopentezos=self.webpackChunkopentezos||[]).push([[5995],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return u}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=a,m=c["".concat(s,".").concat(u)]||c[u]||h[u]||i;return n?o.createElement(m,r(r({ref:t},d),{},{components:n})):o.createElement(m,r({ref:t},d))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var p=2;p<i;p++)r[p]=n[p];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4635:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return d},default:function(){return c}});var o=n(7462),a=n(3366),i=(n(7294),n(3905)),r=["components"],l={id:"set-up-a-node",title:"Set-up a node",authors:"Maxime Sallerin"},s=void 0,p={unversionedId:"deploy-a-node/set-up-a-node",id:"deploy-a-node/set-up-a-node",title:"Set-up a node",description:"In this chapter, we will see how to create and deploy your own node.",source:"@site/docs/deploy-a-node/set-up-a-node.md",sourceDirName:"deploy-a-node",slug:"/deploy-a-node/set-up-a-node",permalink:"/opentezos/deploy-a-node/set-up-a-node",editUrl:"https://gitlab.com/tezos-paris-hub/opentezos/-/blob/main/docs/deploy-a-node/set-up-a-node.md",tags:[],version:"current",lastUpdatedBy:"Aymeric",lastUpdatedAt:1628108608,formattedLastUpdatedAt:"8/4/2021",frontMatter:{id:"set-up-a-node",title:"Set-up a node",authors:"Maxime Sallerin"},sidebar:"docs",previous:{title:"Installation",permalink:"/opentezos/deploy-a-node/installation"},next:{title:"What about networks?",permalink:"/opentezos/deploy-a-node/networks"}},d=[{value:"Node initial configuration (This is optional)",id:"node-initial-configuration-this-is-optional",children:[],level:3},{value:"Node identity",id:"node-identity",children:[],level:3},{value:"Node synchronisation",id:"node-synchronisation",children:[{value:"Downloading snapshot",id:"downloading-snapshot",children:[],level:4},{value:"Importing a snapshot",id:"importing-a-snapshot",children:[],level:4},{value:"Snapshot information",id:"snapshot-information",children:[],level:4}],level:3},{value:"Starting the node",id:"starting-the-node",children:[],level:3},{value:"Conclusion",id:"conclusion",children:[],level:2},{value:"References",id:"references",children:[],level:2}],h={toc:d};function c(e){var t=e.components,n=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"In this chapter, we will see how to create and deploy your own node."),(0,i.kt)("h3",{id:"node-initial-configuration-this-is-optional"},"Node initial configuration (This is optional)"),(0,i.kt)("p",null,"It is possible to define the directory where the data will be stored with ",(0,i.kt)("inlineCode",{parentName:"p"},"--data-dir")," (by default, it is in .tezos-node)"),(0,i.kt)("p",null,"By default, the network is Mainnet but, you can specify the network with the ",(0,i.kt)("inlineCode",{parentName:"p"},"--network")," option."),(0,i.kt)("p",null,"For example, the following command configure the node for the Florencenet Network and stores data in a specified directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"./tezos-node config init --data-dir ~/tezos-florencenet --network florencenet`.\n")),(0,i.kt)("p",null,"More about Networks in the ",(0,i.kt)("a",{parentName:"p",href:"/deploy-a-node/networks"},"Networks chapter"),"."),(0,i.kt)("p",null,"If you want to know more about possible alternative node configurations, check out ",(0,i.kt)("a",{parentName:"p",href:"https://tezos.gitlab.io/user/node-configuration.html"},"Node Configuration")),(0,i.kt)("h3",{id:"node-identity"},"Node identity"),(0,i.kt)("p",null,"First, you must generate a new identity in order to connect to the Tezos network."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"cd tezos\n./tezos-node identity generate\n")),(0,i.kt)("p",null,"The identity comprises a pair of cryptographic keys that nodes use to encrypt the messages sent to each other. "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Note that this is merely a network identity. It is not related in any way to a Tezos address on the blockchain.")),(0,i.kt)("p",null,"It will take some time to generate the keys. An ",(0,i.kt)("inlineCode",{parentName:"p"},"identity.json")," file will then be generated in the ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.tezos-node")," (by default) directory. It will contain our public and private keys. Keep it safe and secure!"),(0,i.kt)("h3",{id:"node-synchronisation"},"Node synchronisation"),(0,i.kt)("p",null,"Whenever a node starts, it tries to retrieve the most current head of the chain from its peers and all the block from the Genesis to that head. This can be a long process if there are many blocks to retrieve."),(0,i.kt)("p",null,"So, rather than taking days to download the Tezos blockchain from the P2P network, a node can be quickly synchronized in a few minutes from a ",(0,i.kt)("strong",{parentName:"p"},"snapshot"),"."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The term snapshot is a bit of an unfortunate term as it already has another meaning in Tezos, which is the schedule for baking rights. To be clear, the snapshot we are talking about is completely different from the baking rights snapshot. This snapshot is a compressed copy of the chain from a certain block.\nTo learn more about snapshots, ",(0,i.kt)("a",{parentName:"p",href:"https://blog.nomadic-labs.com/introducing-snapshots-and-history-modes-for-the-tezos-node.html"},"here")," is an article from Nomadics Labs.")),(0,i.kt)("h4",{id:"downloading-snapshot"},"Downloading snapshot"),(0,i.kt)("p",null,"Download the correct snapshot depending on whether you want to configure your node on the ",(0,i.kt)("a",{parentName:"p",href:"/deploy-a-node/networks#Mainnet"},"Mainnet")," or on a ",(0,i.kt)("a",{parentName:"p",href:"/deploy-a-node/networks#est-networks"},"Testnet"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Download the last ",(0,i.kt)("strong",{parentName:"li"},"rolling")," snapshot on this site ",(0,i.kt)("a",{parentName:"li",href:"https://snapshots-tezos.giganode.io/"},"snapshots-tezos.giganode.io")," (use the 'WEB' link)",(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"The file is about 1.3 GB and should take a few minutes to download."))),(0,i.kt)("li",{parentName:"ol"},"Copy the file into the ",(0,i.kt)("inlineCode",{parentName:"li"},"/tezos")," folder.")),(0,i.kt)("p",null,"A snapshot contains all the blocks from genesis to some point or at least x cycles in the past."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"rolling mode")," are the most lightweight snapshots. Keeping a minimal rolling fragment of the chain and deleting everything before this fragment. Safe for baking, endorsing, and validating new blocks."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"full mode")," store all chain data since the genesis block of the chain, but drop the archived contexts below the current checkpoint. Safe for baking, endorsing, and validating new blocks.")),(0,i.kt)("h4",{id:"importing-a-snapshot"},"Importing a snapshot"),(0,i.kt)("p",null,"The mechanism of Snapshots can help to reduce the synchronization time."),(0,i.kt)("p",null,"The following command bootstraps an empty Tezos node from the ",(0,i.kt)("inlineCode",{parentName:"p"},"<snapshot.rolling>")," file to a rolling Tezos node."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"./tezos-node snapshot import <snapshot.rolling>\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This command should take a few minutes.")),(0,i.kt)("p",null,"You can add the ",(0,i.kt)("inlineCode",{parentName:"p"},"--block <BLOCK_HASH>")," option argument to verify that the block contained in the snapshot is the one that you are expecting to import. Otherwise, don\u2019t forget to check the hash of the imported block displayed by the node when importing."),(0,i.kt)("h4",{id:"snapshot-information"},"Snapshot information"),(0,i.kt)("p",null,"When retrieving a snapshot, it can be useful to check the actual content of the snapshot. To do so, the node\u2019s ",(0,i.kt)("inlineCode",{parentName:"p"},"snapshot info")," command can be used to display snapshot\u2019s information such as:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"snapshot\u2019s version"),(0,i.kt)("li",{parentName:"ul"},"chain name"),(0,i.kt)("li",{parentName:"ul"},"history mode"),(0,i.kt)("li",{parentName:"ul"},"targeted block hash, level and timestamp"),(0,i.kt)("li",{parentName:"ul"},"\u2026")),(0,i.kt)("p",null,"The command can be used as following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"./tezos-node snapshot info <snapshot.rolling>\n")),(0,i.kt)("h3",{id:"starting-the-node"},"Starting the node"),(0,i.kt)("p",null,"With the following command, the node will now catch up syncing with the live network."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"./tezos-node run --rpc-addr 127.0.0.1:8732 --log-output tezos.log &\n")),(0,i.kt)("p",null,"The parameter ",(0,i.kt)("inlineCode",{parentName:"p"},"--rpc-addr url:port")," activate's the RPC interface that will allow communication with the node. By default, it runs on port ",(0,i.kt)("inlineCode",{parentName:"p"},"8732"),", so it is not mandatory to specify it."),(0,i.kt)("p",null,"Watch the progress by viewing tezos.log"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"tail -f tezos.log\n")),(0,i.kt)("p",null,"To stop viewing the log, press CTRL+C (Ubuntu and Mac OS)."),(0,i.kt)("p",null,"The Tezos client can be used to interact with the node. It can query its status or ask the node to perform some actions. For example, after starting your node, you can check if it has finished synchronizing with the following command (you can use another terminal window if you still watch the log):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"./tezos-client bootstrapped\n")),(0,i.kt)("p",null,"When you see the message ",(0,i.kt)("inlineCode",{parentName:"p"},"Node is Bootstrapped"),", your Tezos node is synced with the blockchain, and you may now perform operations on it."),(0,i.kt)("p",null,"Congratulations on setting up a node!"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Be careful closing terminal windows because ",(0,i.kt)("strong",{parentName:"p"},"this stops the node"),".")),(0,i.kt)("h2",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"In this module, we have seen how to install Tezos from sources, create our own node, synchronize it with the blockchain and finally launch it."),(0,i.kt)("p",null,"This module is a prerequisite to becoming a baker, and the ",(0,i.kt)("a",{parentName:"p",href:"/baker"},"Deploy Bakers")," module explains how to become a baker and start earning Tez rewards."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("p",null,"[1]"," ",(0,i.kt)("a",{parentName:"p",href:"https://tezos.gitlab.io/introduction/howtouse.html#node-identity"},"https://tezos.gitlab.io/introduction/howtouse.html#node-identity")),(0,i.kt)("p",null,"[2]"," ",(0,i.kt)("a",{parentName:"p",href:"https://www.coincashew.com/coins/overview-xtz/guide-how-to-setup-a-baker/install-a-tezos-node"},"https://www.coincashew.com/coins/overview-xtz/guide-how-to-setup-a-baker/install-a-tezos-node")),(0,i.kt)("p",null,"[3]"," ",(0,i.kt)("a",{parentName:"p",href:"https://quantifyfitness.com/how-to-solo-bake-tezos-step-by-step-guide/"},"https://quantifyfitness.com/how-to-solo-bake-tezos-step-by-step-guide/")),(0,i.kt)("p",null,"[4]"," ",(0,i.kt)("a",{parentName:"p",href:"https://blog.nomadic-labs.com/introducing-snapshots-and-history-modes-for-the-tezos-node.html"},"https://blog.nomadic-labs.com/introducing-snapshots-and-history-modes-for-the-tezos-node.html")),(0,i.kt)("p",null,"[5]"," ",(0,i.kt)("a",{parentName:"p",href:"https://tezos.gitlab.io/user/node-configuration.html"},"https://tezos.gitlab.io/user/node-configuration.html")))}c.isMDXComponent=!0}}]);