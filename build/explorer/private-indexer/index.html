<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Private indexer | OpenTezos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://opentezos.com/explorer/private-indexer"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Private indexer | OpenTezos"><meta data-react-helmet="true" name="description" content="The tools presented in this module so far are fully public: everyone can use them. However, they are meant"><meta data-react-helmet="true" property="og:description" content="The tools presented in this module so far are fully public: everyone can use them. However, they are meant"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://opentezos.com/explorer/private-indexer"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/explorer/private-indexer" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/explorer/private-indexer" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5fe771a9.css">
<link rel="preload" href="/assets/js/runtime~main.877a41f6.js" as="script">
<link rel="preload" href="/assets/js/main.af038137.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://gitlab.com/tezos-paris-hub/opentezos/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Gitlab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="margin-left:2px">üåô</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="margin-left:1px">‚òÄÔ∏è</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/blockchain-basics">Blockchain Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/tezos-basics">Tezos Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/deploy-a-node">Deploy a node</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/explorer">How to use an Explorer</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer/indexer-explained">How Indexers Work?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer/available-tezos-indexers">Available Tezos Explorers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer/tzstats-main-features">How to use the tzStats blockchain explorer?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer/tzstats-smart-contract">Checkout your smart contract on TzStats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/explorer/private-indexer">Private indexer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/explorer/exam">Exam</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/archetype">Archetype</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/smartpy">SmartPy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/ligo">LIGO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/michelson">Michelson</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/dapp">Build a Dapp</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/baking">Baking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/defi">DeFi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/formal-verification">Formal Verification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/private">Private Blockchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/contribute">How to contribute</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Private indexer</h1></header><p>The tools presented in this module so far are fully public: everyone can use them. However, they are meant
for public networks, and the user is dependent on the infrastructure and configuration of these services. Some
organizations are more interested in deploying their private Tezos network, either for private testing before going
public or for entirely private use. Refer to the <a href="/private">Private blockchain module</a> for more info. Therefore, it is
possible to use an indexer on private networks.</p><p>Fortunately, many public developments on Tezos are open-source and can easily be adapted for a private network, i.e. an indexer can be deployed and configured to watch a private network.</p><p>In this chapter, we will see how the source code of <em>TzIndex</em> and <em>TzStats</em> can be used to make a private indexer,
either for use on a private network or a public network.</p><p>This chapter is divided into three parts:</p><ul><li>how to quickly set up a private network.</li><li>how to install and configure these tools</li><li>how to use them</li></ul><header><h1>Prerequisites</h1></header><p>We will simulate a private network that will be indexed by <em>TzIndex</em>. Therefore, this private network should hold the basic expected elements on any network:</p><ul><li>a few funded accounts</li><li>a smart contract</li><li>some operations</li></ul><p>Let&#x27;s start by setting up a private network. The process is quite difficult as it requires starting and configuring
Tezos nodes (please refer to the <a href="/private">Private Blockchain module</a> for more info). Instead, let&#x27;s choose an easier
way by only simulating a private network using <em>Ganache</em>, a node module used for tests and simulations of Tezos and
Ethereum blockchains. <em>Ganache</em> launches the <a href="https://assets.tqtezos.com/docs/setup/2-sandbox/" target="_blank" rel="noopener noreferrer">Flextesa docker image</a>, which runs Tezos nodes, bakers and endorsers in a sandbox environment.
It also provides ten funded accounts from the start.</p><p>Let&#x27;s use the <em>Raffle</em> smart contract from the <a href="/ligo/contracts-ligo">LIGO module</a> and migrate it onto our private
network using the <em>Truffle</em> configuration from the <a href="/dapp">Build a Dapp module</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="installing-the-prerequisites">Installing the prerequisites<a aria-hidden="true" class="hash-link" href="#installing-the-prerequisites" title="Direct link to heading">‚Äã</a></h2><p>The complete source code of the raffle contract can be
found <a href="https://github.com/bepi-octo/raffle-smart-contract.git" target="_blank" rel="noopener noreferrer">here</a>.</p><p>It contains a ganache configuration (with predefined accounts), three smart contracts and their associated migrations:</p><ol><li>the first contract holds a big map and does not do anything. This dummy contract is used to bypass a <em>TzStats</em> bug
regarding big maps: the first big map (whose index is 0) is not fetched by the frontend.</li><li>a raffle contract using a map</li><li>a raffle using a big map</li></ol><p>The second and third smart contracts will highlight the difference between the way maps and big maps are handled by indexers.</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> examples/explorer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -g truffle@tezos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><em>TzIndex</em> is written in <em>Go</em>, a statically typed compiled programming language developed by <em>Google</em>. Install it using
the instructions at <a href="https://golang.org/doc/install" target="_blank" rel="noopener noreferrer">golang.org/doc/install</a>.</p><p>The next action is to install the docker images of <em>TzIndex</em>. Install <em>Docker</em> using the instructions
at <a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener noreferrer">docs.docker.com/get-docker/</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="launching-ganache">Launching Ganache<a aria-hidden="true" class="hash-link" href="#launching-ganache" title="Direct link to heading">‚Äã</a></h2><p>In <code>package.json</code>, one script is defined:</p><div class="codeBlockContainer_K1bP language-json"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property" style="color:#36acaa">&quot;start-sandbox&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ganache-cli --flavor tezos --seed alice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="root_2W3B"><p>The npm repository of ganache can be found <a href="https://www.npmjs.com/package/ganache-cli/v/6.4.2" target="_blank" rel="noopener noreferrer">here</a>: There are several versions of `ganache-cli`. Only the versions suffixed by `-tezos` support the Tezos blockchain (you can find them under the versions tab). The specific version used in the project can be found in the `devDependencies` section in `package.json`. When this article was written, the version was <a href="https://www.npmjs.com/package/ganache-cli/v/6.12.1-tezos.0" target="_blank" rel="noopener noreferrer">6.12.1-tezos.0</a></p></div><p>This script starts a simulated private Tezos blockchain with <em>ganache</em>:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> run start-sandbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ganache CLI v6.12.1-tezos.0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ganache-core: </span><span class="token number" style="color:#36acaa">2.13</span><span class="token plain">.2-tezos.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available Accounts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alice </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkvGfYw3LyB1UcCahKQk4rF2tvbMUk8GFiTuMjL75uGXrpvKXhjn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bob </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkurPsQ8eUApnLUJ9ZPDvu98E8VNj4KtJa1aZr16Cr5ow5VHKnz4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1aSkwEot3L2kmUvcoxzjMomb9mvBNuzFK6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eve </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpku9qEgcyfNNDK6EpMvu5SqXDqWRLuxdMxdyH12ivTUuB1KXfGP4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1MnmtP4uAcgMpeZN6JtyziXeFqqwQG6yn6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mallory </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkujwsG5JMrWVXQwmRMBoR9yJkokRbn6wy3monpQKBpnZTs1ogRR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1R2oNqANNy2vZhnZBJc8iMEqW79t85Fv7L</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trent </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkukjpYWLPEavoTXid8KqfYAY4J1rqtbWHWrzp22FgdRQqzaRkDD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1TfRXkAxbQ2BFqKV2dF4kE17yZ5BmJqSAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">marketa </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpktiaGKkt8Yu6m4Gse2GhMdJCVdCtcrjtqATn3y3sf7xTBDj5g2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1fhigafd7PQAh3JBvq7efZ9g6cgBkaimJX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eulalie </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkvCvic2obeedM7oMJaeyapEafg4dSdYuWvkZigKbcvc64q6ZKM7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1fEqJ6rD3mfQjVat7G6XJP522V6V8wWTP2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stella </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkvRuciP6vZeoXn1KJtBuEEtaD2SpHW59wbbCGt1SEDBL94W7AUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1i3eqdPNs9zjpavVBFcF8JarJUgEErfsUK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">carline </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpktxefxf3dtJEQLVb72MjV8yMiLh6DfCgNJQUV81rnsYJoZhbnK8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1PQP815EzZRktgLaEhtDCR22kiRrcQEurw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tabbie </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> TEZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pk: edpkvXobE6tQLdsm3kPu3MYT2z2XrgVchfkK2WPB9tniNXdWSRyud3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pkh: tz1WP3xUvTP6vUWLRnexxnjNTYDiZ7QzVdxo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Notice all the funded accounts created by <em>Ganache</em>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="migrating-the-raffle-contracts">Migrating the <em>Raffle</em> contracts<a aria-hidden="true" class="hash-link" href="#migrating-the-raffle-contracts" title="Direct link to heading">‚Äã</a></h2><p>The contracts can be migrated onto the private network. More details can be found about the <em>Truffle</em> tool in
the <a href="/dapp">Build a Dapp module</a>.</p><p>First, the private network has to be defined in the <em>truffle-config.js</em> file. A <code>development</code> subsection should be found
under the <code>networks</code> section:</p><div class="codeBlockContainer_K1bP language-json"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">    development</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8732</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network_id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secretKey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> alice.sk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tezos&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It defines a localhost network, matching the ganache private network.</p><p>We&#x27;re going to use the accounts from the <code>scripts/sandbox/account.js</code> file. Our three contracts can now be migrated with this command:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ truffle migrate --network development</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Three contracts are now deployed onto our private network:</p><p>The migration files also include some operations to open a raffle and buy a ticket automatically once the contracts are
deployed.</p><div class="root_2W3B"><p>The same smart contract is deployed twice: one with _maps_ and the other with _big maps_. Later on, these two smart contracts will be used to highlight the difference between the processing of _maps_ and _big maps_ by _TzStats_.</p></div><header><h1>Setting up a private indexer (<em>TzIndex</em>)</h1></header><p><em>TzIndex</em> is an open-source indexer: it can freely be used and modified. The source code is available
at <a href="https://github.com/blockwatch-cc/tzindex" target="_blank" rel="noopener noreferrer">github.com/blockwatch-cc/tzindex</a></p><p>To start the application, proceed as follows:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/blockwatch-cc/tzindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> tzindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> tzindex</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The last command should output &quot;tzindex&quot; (to check if a tzindex has indeed been built)
A <em>TzIndex</em> binary is created in the same directory. The indexer can now watch the private network with this command:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./tzindex run --rpcurl </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:8732 --notls --enable-cors</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note the following options:</p><ul><li><em>--rpcurl</em>: url of the ganache private network rpc node</li><li><em>--notls</em>: option to use <em>http</em> instead of <em>https</em></li><li><em>--enable-cors</em>: <em>TzIndex</em> API will be queried by <em>Tzstat</em> (exposed on a different port): CORS need to be enabled</li></ul><p><em>TzIndex</em> now exposes its API on http://localhost:8000.</p><p>A <code>db/</code> folder is created when launching <em>TzIndex</em> for the first time: it contains all the data indexed about the
private network.</p><div class="root_2W3B"><p>When restarting ganache, a blank new network is created. The `db/` folder, containing the old data has to be removed in order to make _TzIndex_ index the new network.</p></div><header><h1>Setting up a private explorer (<em>TzStats</em>)</h1></header><p><em>TzStats</em> is the open-source frontend made to display the data from <em>TzIndex</em>. The source code is available
at <a href="https://github.com/blockwatch-cc/tzstats" target="_blank" rel="noopener noreferrer">github.com/blockwatch-cc/tzstats</a></p><p><em>TzStats</em> can interact with <em>TzIndex</em> by setting the <em>TZSTATS_API_URL</em> variable to the url of the <em>TzIndex</em> API.</p><p>The application can be launched with:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/blockwatch-cc/tzstats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> tzstats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;TZSTATS_API_URL=http://localhost:8000&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> development.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> start</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="root_2W3B"><p>An error might occur during the npm install: ```shell /bin/sh: 1: sass: not found ``` If so, modify the `sass` field under `scripts` in the `package.json` file as follows: ```json &quot;sass&quot;: &quot;npx sass src/styles/scss/index.scss:src/styles/css/index.css&quot; ``` Then run `npm install` again.</p></div><p><em>TzStats</em> will now launch in your web browser.</p><header><h1>Interacting with the private explorer</h1></header><p>At this point, the working context is:</p><ul><li>a simulated private network running through Ganache</li><li>three migrated contracts</li><li>two contract calls</li><li><em>TzIndex</em> indexing the private network</li><li><em>TzStats</em> connected to <em>TzIndex</em>, and running</li></ul><p>This means that there has already been some activity that we can watch on our network.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="watching-activity-on-tzstats">Watching activity on <em>TzStats</em><a aria-hidden="true" class="hash-link" href="#watching-activity-on-tzstats" title="Direct link to heading">‚Äã</a></h2><p><em>TzStats</em> is running at http://localhost:3000:</p><p><img src="/assets/images/tzstat-1-5333ef49d7554b152eb60a528dcf233b.png" title="Welcome page of a private tzstats"></p><p>Notice that the frontend is different from its public version on <a href="https://tzstats.com/" target="_blank" rel="noopener noreferrer">TzStats.com</a> but the inner
workings are the same.</p><p>On top, the search bar allows you to search for transactions, blocks, addresses, etc. The left panel contains various information displayed, such as the number of baked blocks.</p><p>Click on it to get more info on that block:
<img src="/assets/images/tzstat-2-b5c281fa7c09fb6b1fd98579e5b09dd4.png" title="Block details page"></p><p>Many block details are displayed; most of them can be clicked on for even more info. The block above only contains one
operation, which is a call to our smart contracts. Click the hash to open the operation page:</p><p><img src="/assets/images/tzstat-3-730c9078e8851ade4c545b5e2b8f0717.png" title="Smart contract call details page"></p><p>The sender does match Alice&#x27;s <code>pkh</code> from <em>scripts/sandbox/account.js</em>. <code>pkh</code> means public key hash: it is an address on a Tezos network.
Notice the contract address matches the returned address from the migration output logs.</p><p>Click on the address to inspect the smart contract:
<img src="/assets/images/tzstat-4-e878a50eb58f6ea2a85bb999e9e4c4b1.png" title="Smart contract details page"></p><p>You can see the history of calls, the entrypoints, the storage, etc. Notice the two calls made by <em>Truffle</em>: the
origination of the contract and the purchase of a ticket.</p><p>The storage page displays the storage definition, the type of each field and their associated current value. Note that
one participant is registered in the raffle and the contract holds one Tez (from selling one ticket).
<img src="/assets/images/tzstat-5-5b336bee4b019288dcb1d8cc9c44046b.png" title="Smart contract storage page"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="about-big-maps">About big maps<a aria-hidden="true" class="hash-link" href="#about-big-maps" title="Direct link to heading">‚Äã</a></h3><p>Note that the <em>sold_tickets</em> <em>big map</em> should hold an <code>address</code> as value, but it displays <code>1</code> in the storage. Indeed,
since <em>big maps</em> are meant to hold unbounded lists of data, they cannot be loaded directly into the storage (out of
performance concerns). Each <em>big map</em> is indexed and the number <code>1</code> being displayed is the index number of the <em>big map</em>
. Its data can actually be accessed by clicking on the <code>Bigmap 1</code> section.</p><p><img src="/assets/images/tzstat-6-7ed14329238212ca4432bfbd38d362eb.png" title="Big map section"></p><p>Regular <em>maps</em> are meant to be used with limited data size as the data is directly retrieved from the storage section.
You can see an example of such a <em>map</em> in the second migrated smart contract (baked in the fourth block):</p><p><img src="/assets/images/tzstat-7-65e1d75e00f7f72205da60973a5f0a35.png" title="Storage page"></p><p>The <em>TzStats</em> interface is user-friendly and every piece of information can easily be read by clicking on each
element. Remember that all this information is coming from the data retrieved by the indexer: <em>TzStats</em> just displays
them.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="watching-activity-from-tzindex">Watching activity from <em>TzIndex</em><a aria-hidden="true" class="hash-link" href="#watching-activity-from-tzindex" title="Direct link to heading">‚Äã</a></h2><p>The same pieces of information can be retrieved without the frontend by just using the <em>TzIndex</em> API. For each page
opened on <em>TzStats</em>, an API call is made to <em>TzIndex</em>. Each API call can be seen in the network explorer by pressing F12
in the network section.</p><p><img src="/assets/images/tzstat-8-09e22e1251e10ac3034d2a8a00a2d7ee.png" title="Retrieving the API call"></p><p>The <em>request URL</em> shows the called API endpoints:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ GET http://127.0.0.1:8000/explorer/contract/KT1HJ8VJ9rHkoi4FfzHPburSe1VdYn8AU4AF?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;address&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KT1HJ8VJ9rHkoi4FfzHPburSe1VdYn8AU4AF&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;manager&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;delegate&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;height&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;fee&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.003939</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;gas_limit&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12826</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;gas_used&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12726</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;gas_price&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.30952</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;storage_limit&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2654</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;storage_size&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2397</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;storage_paid&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2397</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;is_funded&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;is_vesting&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;is_spendable&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;is_delegatable&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;is_delegated&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_in&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_out&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_in&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_out&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_seen&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_seen&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;delegated_since&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_in_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-17T17:06:27Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_out_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0001-01-01T00:00:00Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_in_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-17T17:06:27Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_out_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0001-01-01T00:00:00Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;first_seen_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-17T17:06:26Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;last_seen_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-17T17:06:27Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;delegated_since_time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0001-01-01T00:00:00Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;n_ops&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;n_ops_failed&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;n_tx&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;n_delegation&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;n_origination&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;token_gen_min&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;token_gen_max&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;bigmap_ids&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;op_l&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;op_p&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;op_i&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;iface_hash&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;d30a2146&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;call_stats&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>A lot of information is displayed, such as the contract&#x27;s address, but some data is also missing, like the storage.
Another API call has to be made for that:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ GET http://127.0.0.1:8000/explorer/contract/KT1HJ8VJ9rHkoi4FfzHPburSe1VdYn8AU4AF/storage?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;meta&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;contract&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KT1HJ8VJ9rHkoi4FfzHPburSe1VdYn8AU4AF&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;time&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2021-04-17T17:06:27Z&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;height&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;block&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;BLwCojKb2fv7Ph88kxMoYXeTRYdtavvzCNh3ZzsJNpfFgqq5ey8&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tz1cGftgD3FuBmBhcwY24RaMm5D2UXLr5LHW&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;close_date&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1618679185827&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;contract_name&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Raffle smart contract with big map&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;description&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;jackpot&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;100&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;players&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;raffle_is_open&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;sold_tickets&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;winning_ticket_number_hash&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;00&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>All the available endpoints can be found here: <a href="https://tzstats.com/docs/api#explorer-endpoints" target="_blank" rel="noopener noreferrer">tzstats.com/docs/api#explorer-endpoints</a></p><header><h1>Setting up a private indexer for a public network</h1></header><p>If you don&#x27;t want your infrastructure to rely on third-party public indexers to monitor public networks, you can also use a local indexer. It just has to monitor a node: either a local node, or a public node (listed at <a href="https://tezostaquito.io/docs/rpc_nodes/" target="_blank" rel="noopener noreferrer">tezostaquito.io/docs/rpc_nodes</a>).</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./tzindex run --rpcurl </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">node_url</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --notls --enable-cors</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>There are three operation modes, which retrieve more or less data:</p><ul><li><em>Full regular</em>: all indexes are built (default mode)</li><li><em>Light light-weight</em>: consensus and governance indexes are not built (use <em>--light</em> in the CLI)</li><li><em>Validate</em>: state validation mode for checking accounts and balances at each block/cycle (use <em>--validate</em> in the CLI)</li></ul><p>Note that whichever mode your choose, indexing a public network will take a significant amount of time due to the size of data to be
fetched. </p><p>According to the <em>Tzstats</em> team, it is possible to index 13 000 blocks per minute from a local node connected to the mainnet (<a href="https://tzstats.com/blog/next-gen-blockchain-indexing-for-tezos/" target="_blank" rel="noopener noreferrer">Cost and benefice section from this tzstats post</a>). When indexing the mainnet from a public node (<em>Smartpy</em> node on our case), we could index about 10 blocks per seconde. </p><p>The mainnet was about 1 400 000 blocks, so to index the mainnet, it should take:</p><ul><li>about an hour and fifty minutes from a local node</li><li>about a day and a half from a public node. </li></ul><p>Of course, these figures depend on your network connectivity and hardware.</p><header><h1>Conclusion</h1></header><p>Running a private network does not condemn its user to be blind to whatever is happening on their network: private
indexers and explorers can be set up to index and monitor a private network.</p><p>Public networks (mainnet, testnets) are indexed by public tools (<!-- -->[https://tzstats.com/]<!-- --> for instance). However, some use cases may required not to rely on third party services: private indexers and explorers can be used to that purpose.</p><p>Finally, indexers, since they expose a complete API, can be used to replace libraries (such as <a href="https://tezostaquito.io/" target="_blank" rel="noopener noreferrer">Taquito</a>) or
wallets. Decentralised apps can take advantage of these API calls to fetch data from a Tezos network, especially when it comes down to big maps.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="references">References<a aria-hidden="true" class="hash-link" href="#references" title="Direct link to heading">‚Äã</a></h2><p>[1]<!-- --> <a href="https://assets.tqtezos.com/docs/setup/2-sandbox/" target="_blank" rel="noopener noreferrer">https://assets.tqtezos.com/docs/setup/2-sandbox/</a></p><p>[2]<!-- --> <a href="https://tzstats.com/docs/api#explorer-endpoints" target="_blank" rel="noopener noreferrer">https://tzstats.com/docs/api#explorer-endpoints</a></p><p>[3]<!-- --> <a href="https://golang.org/doc/install" target="_blank" rel="noopener noreferrer">https://golang.org/doc/install</a></p><p>[4]<!-- --> <a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/get-docker/</a></p><p>[5]<!-- --> <a href="https://tezostaquito.io/docs/rpc_nodes/" target="_blank" rel="noopener noreferrer">https://tezostaquito.io/docs/rpc_nodes/</a></p><p>[6]<!-- --> <a href="https://tezostaquito.io/" target="_blank" rel="noopener noreferrer">https://tezostaquito.io/</a></p><p>[7]<!-- --> <a href="https://tzstats.com/" target="_blank" rel="noopener noreferrer">https://tzstats.com/</a></p><p>[8]<!-- --> <a href="https://tzstats.com/blog/next-gen-blockchain-indexing-for-tezos/" target="_blank" rel="noopener noreferrer">https://tzstats.com/blog/next-gen-blockchain-indexing-for-tezos/</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://gitlab.com/tezos-paris-hub/opentezos/-/blob/main/docs/explorer/private-indexer.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-08-01T15:13:36.000Z">8/1/2021</time></b> by <b>Aymeric</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/explorer/tzstats-smart-contract"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Checkout your smart contract on TzStats</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/explorer/exam"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exam<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installing-the-prerequisites" class="table-of-contents__link toc-highlight">Installing the prerequisites</a></li><li><a href="#launching-ganache" class="table-of-contents__link toc-highlight">Launching Ganache</a></li><li><a href="#migrating-the-raffle-contracts" class="table-of-contents__link toc-highlight">Migrating the <em>Raffle</em> contracts</a></li><li><a href="#watching-activity-on-tzstats" class="table-of-contents__link toc-highlight">Watching activity on <em>TzStats</em></a><ul><li><a href="#about-big-maps" class="table-of-contents__link toc-highlight">About big maps</a></li></ul></li><li><a href="#watching-activity-from-tzindex" class="table-of-contents__link toc-highlight">Watching activity from <em>TzIndex</em></a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 OpenTezos.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.877a41f6.js"></script>
<script src="/assets/js/main.af038137.js"></script>
</body>
</html>