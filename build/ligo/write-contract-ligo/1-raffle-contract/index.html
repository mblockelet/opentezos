<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Raffle contract | OpenTezos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://opentezos.com/ligo/write-contract-ligo/1-raffle-contract"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Raffle contract | OpenTezos"><meta data-react-helmet="true" name="description" content="The language used in smart contracts on Tezos is Michelson, a stack-based language. However, this kind of language is not commonly used by developers and as the code becomes complex and longer, it gets increasingly harder to keep readable and clean code in Michelson. However, the Tezos ecosystem provides a number of high level languages, which make smart contracts development as easy as any application development. LIGO is one of these languages."><meta data-react-helmet="true" property="og:description" content="The language used in smart contracts on Tezos is Michelson, a stack-based language. However, this kind of language is not commonly used by developers and as the code becomes complex and longer, it gets increasingly harder to keep readable and clean code in Michelson. However, the Tezos ecosystem provides a number of high level languages, which make smart contracts development as easy as any application development. LIGO is one of these languages."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://opentezos.com/ligo/write-contract-ligo/1-raffle-contract"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/ligo/write-contract-ligo/1-raffle-contract" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://opentezos.com/ligo/write-contract-ligo/1-raffle-contract" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5fe771a9.css">
<link rel="preload" href="/assets/js/runtime~main.add3a37c.js" as="script">
<link rel="preload" href="/assets/js/main.af038137.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo-dark.svg" alt="OpenTezos" class="themedImage_1VuW themedImage--dark_hz6m"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://gitlab.com/tezos-paris-hub/opentezos/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Gitlab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="margin-left:2px">üåô</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="margin-left:1px">‚òÄÔ∏è</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/blockchain-basics">Blockchain Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/tezos-basics">Tezos Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/deploy-a-node">Deploy a node</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/explorer">How to use an Explorer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/archetype">Archetype</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/smartpy">SmartPy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/ligo">LIGO</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/ligo/write-contract-ligo/1-raffle-contract">Raffle example</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ligo/write-contract-ligo/1-raffle-contract">Raffle contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/write-contract-ligo/2-launch-raffle">Launch raffle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/write-contract-ligo/3-buy-ticket">Buy ticket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/write-contract-ligo/4-close-raffle">Close raffle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/write-contract-ligo/5-refactoring">Refactoring</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/deploy-a-contract">Compiling and deploying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/unit-testing">Unit Testing with PyTezos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/examples">More examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/exam">Exam</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ligo/take-away">Take Away</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/michelson">Michelson</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/dapp">Build a Dapp</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/baking">Baking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/defi">DeFi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/formal-verification">Formal Verification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/private">Private Blockchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/contribute">How to contribute</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Raffle contract</h1></header><p>The language used in smart contracts on Tezos is <a href="/michelson/introduction">Michelson</a>, a stack-based language. However, this kind of language is not commonly used by developers and as the code becomes complex and longer, it gets increasingly harder to keep readable and clean code in Michelson. However, the Tezos ecosystem provides a number of high level languages, which make smart contracts development as easy as any application development. LIGO is one of these languages.</p><p>In this chapter, we will focus on smart contract development with the LIGO language (and particularly the <em>PascaLigo</em> syntax). The most important aspects of LIGO will be covered here.</p><p>If you want to learn the complete LIGO syntax, you can take a look at:</p><ol><li><a href="https://ligolang.org/docs/intro/introduction" target="_blank" rel="noopener noreferrer">The official Ligolang documentation</a>: a complete reference maintained by the developing team.</li><li><a href="https://tezosacademy.io/" target="_blank" rel="noopener noreferrer">Tezos Academy</a>: a gamified interactive tutorial with 30 examples. </li></ol><p>This chapter has been written with a smart contract development approach. Each part starts with an explanation of the LIGO syntax (called <em>LIGO prerequisite</em> sections) that are later used for smart contract development.</p><p>The <em>LIGO prerequisite</em> parts can be skipped if you do not want to learn the <em>PascaLigo</em> syntax.</p><div class="root_2W3B"><p></p><p>DISCLAIMER: This smart contract is meant for educational purpose only, and is not suitable for any other use. OpenTezos cannot be held responsible for any other use.</p><p></p></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="raffle-smart-contract">Raffle smart contract<a aria-hidden="true" class="hash-link" href="#raffle-smart-contract" title="Direct link to heading">‚Äã</a></h2><p>In this chapter, a simple <a href="https://en.wikipedia.org/wiki/Raffle" target="_blank" rel="noopener noreferrer">raffle</a> example is considered. A raffle is a gambling game, where players buy tickets. The winning ticket is then drawn. In our case, a raffle will be developed in a smart contract with those rules: </p><ul><li>An administrator (with his public address) wants to organize a raffle, which reward is some Tez.</li><li>The administrator pays the reward to the winner with his own funds. </li><li>Anyone can participate in the raffle, and the participation fee is the same for everyone. However, each address can participate only once.</li><li>Each ticket has the same probability of being picked.</li><li>After a given time, defined at the beginning of the raffle, the administrator will close the raffle, and send the reward to the winner.</li></ul><p>This raffle can be divided into three steps:</p><ol><li>A raffle is opened, with a reward, for a given time.</li><li>During the allowed time, anyone can buy a raffle ticket.</li><li>The raffle is closed, the winner is randomly selected and rewarded with the prize.</li></ol><p>Only one raffle session can be ongoing.</p><blockquote><p>Some choices have been made for educational purposes.</p></blockquote><div class="root_2W3B"><p></p><p>About the word <strong>ticket</strong>:
A ticket is a reserved word in Michelson and LIGO, introduced by the Edo protocol.
In this chapter, the word ticket only refers to a raffle ticket. </p><p></p></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="prerequisites-for-smart-contracts-development">Prerequisites for smart contracts development<a aria-hidden="true" class="hash-link" href="#prerequisites-for-smart-contracts-development" title="Direct link to heading">‚Äã</a></h2><p>When developing smart contracts, two tools are extremely useful:</p><ol><li>a LIGO syntax support for your IDE</li><li>a LIGO compiler</li></ol><p>These two tools will point out syntax errors and type-checking errors. However, it is recommended to compile aLigosmart contract as often as possible. The compilation will detect errors that the IDE linter won&#x27;t. Thus, errors will be found early and should be more easily addressed.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="smart-contract-initialization">Smart contract initialization<a aria-hidden="true" class="hash-link" href="#smart-contract-initialization" title="Direct link to heading">‚Äã</a></h2><blockquote><p>We&#x27;re about to see everything that is required to create an empty smart contract:</p><ul><li>Types, built-in types</li><li>Constants, Variables</li><li>Introduction to functions</li><li>main function
-Ligocompilation</li></ul></blockquote><p>A Tezos smart contract has three parts:</p><ol><li><strong>parameter</strong>: possible invocations (function calls) of the smart contract.</li><li><strong>storage</strong>: persistent on-chain data structure. Note that anyone can read this, but only the contract can change it.</li><li><strong>code</strong>: a sequence of Michelson instructions to be executed when invoking a smart contract.</li></ol><p>Compiling a LIGO smart contract will provide us all three parts.</p><p>Let&#x27;s get started! The first step is to create a <em>.ligo</em> file. Let&#x27;s create a file called <code>raffle.ligo</code> which will contain a minimaly viable contract.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="ligo-concepts-used-in-this-part">LIGO concepts used in this part<a aria-hidden="true" class="hash-link" href="#ligo-concepts-used-in-this-part" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_31ik" id="types">Types<a aria-hidden="true" class="hash-link" href="#types" title="Direct link to heading">‚Äã</a></h4><p>LIGO is strongly and statically typed. This means that the compiler checks how a contract processes data, ensuring that each function&#x27;s expectations are met.
If it passes the test, the contract will not fail at run-time due to some inconsistent assumptions on the data. This is called type-checking.</p><p>LIGO types are built on top of the Michelson&#x27;s type system.</p><h5 class="anchor anchorWithStickyNavbar_31ik" id="built-in-types">Built-in types<a aria-hidden="true" class="hash-link" href="#built-in-types" title="Direct link to heading">‚Äã</a></h5><p>LIGO supports all Michelson types, from basic primitives (such as <code>string</code> or <code>int</code>) to composite types (such as <code>option</code>, <code>list</code> or <code>map</code>), including contract-specific types (such as <code>address</code> or <code>tez</code>).</p><p>You can find all built-in types on the <a href="https://gitlab.com/ligolang/ligo/-/tree/dev#L35" target="_blank" rel="noopener noreferrer">LIGO gitlab</a>.</p><p>Below is a table of the most used built-in types. Most of them will be used in the raffle smart contract:</p><table><thead><tr><th>Type</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>unit</code></td><td>carries no information</td><td><code>Unit</code></td></tr><tr><td><code>option</code></td><td>value of some type or none</td><td><code>Some (&quot;this string is defined&quot;)</code>, <code>(None: option string)</code></td></tr><tr><td><code>string</code></td><td>Sequence of character</td><td><code>&quot;This is a string&quot;</code></td></tr><tr><td><code>address</code></td><td>Address of an implicit account</td><td><code>(&quot;tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx&quot; : address)</code></td></tr><tr><td><code>int</code></td><td>Positive or negative integer</td><td><code>-5</code>,  <code>int(1n)</code></td></tr><tr><td><code>nat</code></td><td>Positive integer</td><td><code>0n</code>, <code>abs (1)</code></td></tr><tr><td><code>tez</code>, <code>tz</code>, <code>mutez</code></td><td>Amount in tz or mutez</td><td><code>5mutez</code>, <code>10tez</code></td></tr><tr><td><code>bool</code></td><td>Boolean: true or false</td><td><code>True</code>, <code>False</code></td></tr><tr><td><code>timestamp</code></td><td>Timestamp (bakers are responsible for providing the given current timestamp)</td><td><code>(&quot;2000-01-01T10:10:10Z&quot; : timestamp)</code>, <code>Tezos.now</code></td></tr><tr><td><code>bytes</code></td><td>Sequence of bytes</td><td><code>0x12e4</code></td></tr><tr><td><code>list (type)</code></td><td>List definition. The same element can be found several times in a list</td><td><code>list [1; 2; 2]</code>, <code>nil</code></td></tr><tr><td><code>set (type)</code></td><td>Set definition. The same element cannot be found several times in a list</td><td><code>set []</code>, <code>set [3; 2; 2; 1]</code></td></tr><tr><td><code>type1 * type2 ... * typeN</code></td><td>Tuple definition</td><td><code>(&quot;Alice&quot;, 5n, True)</code></td></tr><tr><td><code>(keyType, valueType) map</code></td><td>Map an element of type <code>keyType</code> to an element of type <code>valueType</code>. Meant for finite maps</td><td><code>Map.empty</code>, <code>Map.literal [((&quot;tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx&quot; : address), (1,2)); ((&quot;tz1gjaF81ZRRvdzjobyfVNsAeSC6PScjfQwN&quot; : address), (0,3))]</code></td></tr><tr><td><code>(keyType, valueType) big_map</code></td><td>Map an element of type <code>keyType</code> to an element of type <code>valueType</code>. Meant for huge maps</td><td><code>Big_map.empty</code>, <code>Big_map.literal [((&quot;tz1KqTpEZ7Yob7QbPE4Hy4Wo8fHG8LhKxZSx&quot; : address), (1,2)); ((&quot;tz1gjaF81ZRRvdzjobyfVNsAeSC6PScjfQwN&quot; : address), (0,3))]</code></td></tr></tbody></table><blockquote><p>As you may have noticed, there is no <code>float</code> type. Indeed, <code>float</code> is not deterministic as its precision depends on the hardware that it runs on.</p></blockquote><h5 class="anchor anchorWithStickyNavbar_31ik" id="type-aliases">Type aliases<a aria-hidden="true" class="hash-link" href="#type-aliases" title="Direct link to heading">‚Äã</a></h5><p>Type aliasing consists in giving a new name to a given type when the context calls for a more precise name.</p><p>It can be used to express our intent more clearly: for instance, a <code>coordinates</code> type defined by a tuple of two integers is meaningful than just using a tuple.</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type coordinates </span><span class="token function" style="color:#d73a49">is</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> my_position </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> coordinates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>‚ö†Ô∏è <code>Tuples</code> will be explained later.</p><p>It is also helpful to define a type for complex structures, such as the expected input and return of a function or the contract storage.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="constants--variables-declaration">Constants &amp; Variables declaration<a aria-hidden="true" class="hash-link" href="#constants--variables-declaration" title="Direct link to heading">‚Äã</a></h4><h5 class="anchor anchorWithStickyNavbar_31ik" id="constants">Constants<a aria-hidden="true" class="hash-link" href="#constants" title="Direct link to heading">‚Äã</a></h5><p>Constants are by design immutable, which means they can only be assigned once, at their declaration. A constant is defined by a name, a type, and a value:</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> int </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_31ik" id="variables">Variables<a aria-hidden="true" class="hash-link" href="#variables" title="Direct link to heading">‚Äã</a></h5><p>Variables, unlike constants, are mutable. They cannot be declared in a global scope, but they can be declared and used within functions or as function parameters.</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> c</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> int </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>‚ö†Ô∏è The assignment operator is different: <code>:=</code> for variables, instead of <code>=</code> for constants.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="introduction-to-functions">Introduction to functions<a aria-hidden="true" class="hash-link" href="#introduction-to-functions" title="Direct link to heading">‚Äã</a></h4><p>As in many other language, LIGO allows to create functions. There are several ways to define a function, but the header is always the same:</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">functionName</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> param1 </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">param2Type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> param2 </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">param2Type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">returnType</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> is</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">code</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Functions will be detailed below. At this point, since the main function does nothing, it will use a <a href="/docs/ligo/write-contracts-ligo#blockless-functions">blockless function</a> definition.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="main-function">Main function<a aria-hidden="true" class="hash-link" href="#main-function" title="Direct link to heading">‚Äã</a></h4><p>Every LIGO smart contract must define a <code>main</code> function. This <code>main</code> function defines <em>operations</em> and updates the contract <em>storage</em>, depending on the contract parameter. It takes two parameters, the <strong>contract parameter</strong> and the <strong>on-chain storage</strong>, and returns a pair made of a <strong>list of operations</strong> and a <strong>(new) on-chain storage</strong>. </p><br><p><img src="/assets/images/main_function-def6ca332b38507cc42b237cc24c24fc.svg"></p><small class="figure">FIGURE 1: Main function</small><br><p>The contract parameter and storage type are up to the contract designer, but the type for the list of operations is not.</p><p>The return type of the <code>main</code> function is as follows (assuming that the <code>storage</code> type has already been defined elsewhere).</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type storage is </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Any name, any type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type returnMainFunction is </span><span class="token function" style="color:#d73a49">list</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> storage</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_31ik" id="ligo-compilation">LIGO compilation<a aria-hidden="true" class="hash-link" href="#ligo-compilation" title="Direct link to heading">‚Äã</a></h4><p>TheLigocode above should now compile with this command:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$Ligocompile</span><span class="token plain">-contract </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ligoFile</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">mainFunction</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If the compilation is successful, the output will be the Michelson code of the contract.</p><p>It is recommended to run this command as often as possible to check the code syntax and the types.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="raffle-storage-initialization">Raffle storage initialization<a aria-hidden="true" class="hash-link" href="#raffle-storage-initialization" title="Direct link to heading">‚Äã</a></h3><p>Now that we have introduced some basic LIGO concepts (<code>type</code>, <code>constant</code>, <code>variable</code>, <code>function</code> and the <code>main</code> function), let&#x27;s design our <em>Raffle</em> smart contract.</p><p>The first step is to define the storage. Contract storage holds the contract data: it can be a single value or a complex structure. The storage definition is a <code>type</code> instruction. First, the storage will be as simple as possible: <em>empty</em>.</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type storage is unit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>‚ö†Ô∏è The word <em>unit</em> is a reserved word of the language and represents an <em>empty type</em>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="raffle-parameter-initialization">Raffle parameter initialization<a aria-hidden="true" class="hash-link" href="#raffle-parameter-initialization" title="Direct link to heading">‚Äã</a></h3><p>The parameter definition lists all the entrypoints of a smart contract, i.e., the names of the functions that can be called from the exterior.</p><p>At this point, the parameter definition will be skipped. It will be defined later on in this chapter.</p><p>To define a smart contract without any parameter definition:</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type raffleEntrypoints is unit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="raffle-code-definition">Raffle code definition<a aria-hidden="true" class="hash-link" href="#raffle-code-definition" title="Direct link to heading">‚Äã</a></h3><p>The last part of a smart contract is the code definition. A smart contract can execute no instruction, but it must always return two things:</p><ol><li>a list of operations</li><li>the storage</li></ol><p>TheLigocompiler expects the smart contract to have at least one function, which is the <code>main</code> function. It does not have to be named that way but it is good practice to do so:</p><div class="codeBlockContainer_K1bP language-js"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type storage is unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type raffleEntrypoints is unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter keyword" style="color:#00009f">const</span><span class="token parameter"> action </span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> raffleEntrypoints</span><span class="token parameter punctuation" style="color:#393A34">;</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#00009f">const</span><span class="token parameter"> store </span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> storage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">list</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> storage </span><span class="token function" style="color:#d73a49">is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nil</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This <code>main</code> function returns return an empty list of operations and the same storage as provided as input.</p><p>The raffle smart contract can now be compiled:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$Ligocompile</span><span class="token plain">-contract raffle.ligo main</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="summing-up">Summing-up<a aria-hidden="true" class="hash-link" href="#summing-up" title="Direct link to heading">‚Äã</a></h3><p>The three Michelson parts have an equivalence in LIGO.</p><table><thead><tr><th>Michelson</th><th>LIGO</th></tr></thead><tbody><tr><td>parameter</td><td><code>type raffleEntrypoints is</code></td></tr><tr><td>storage</td><td><code>type storage is</code></td></tr><tr><td>code</td><td><code>function main (const action : raffleEntrypoints; const store : storage): list (operation) * storage is ((nil: list(operation)), store)</code></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://gitlab.com/tezos-paris-hub/opentezos/-/blob/main/docs/ligo/write-contract-ligo/1-raffle-contract.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-08-06T00:27:39.000Z">8/6/2021</time></b> by <b>Aymeric</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ligo/installation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ligo/write-contract-ligo/2-launch-raffle"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Launch raffle<!-- --> ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#raffle-smart-contract" class="table-of-contents__link toc-highlight">Raffle smart contract</a></li><li><a href="#prerequisites-for-smart-contracts-development" class="table-of-contents__link toc-highlight">Prerequisites for smart contracts development</a></li><li><a href="#smart-contract-initialization" class="table-of-contents__link toc-highlight">Smart contract initialization</a><ul><li><a href="#ligo-concepts-used-in-this-part" class="table-of-contents__link toc-highlight">LIGO concepts used in this part</a></li><li><a href="#raffle-storage-initialization" class="table-of-contents__link toc-highlight">Raffle storage initialization</a></li><li><a href="#raffle-parameter-initialization" class="table-of-contents__link toc-highlight">Raffle parameter initialization</a></li><li><a href="#raffle-code-definition" class="table-of-contents__link toc-highlight">Raffle code definition</a></li><li><a href="#summing-up" class="table-of-contents__link toc-highlight">Summing-up</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 OpenTezos.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.add3a37c.js"></script>
<script src="/assets/js/main.af038137.js"></script>
</body>
</html>